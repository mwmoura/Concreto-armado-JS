<!DOCTYPE html>
<html lang="pt-br">
<head>
    <!-- Dimensionamento de seções retangulares à Flexo-Tração Normal com Armaduras Assimétricas -->
    <!-- ####################################################################################### -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flexo-Tração - Dimensionamento</title>

    <style>
        /* Trecho CSS do código */
        body{
            font: normal 12pt Arial;
            background: rgb(70, 142, 241);
        }

        section{
            background-color: white;
            padding-top: 30px;
            box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.397);
            border-radius: 10px;
            margin: auto;
        }

        td{
            border: solid black 1px;
            text-align: center;
        }

        footer{
            text-align: center;
            padding-top: 50px;
            font-style: italic;
        }

        h1{
            text-align: center;
        }

        table{
            margin: auto;
        }

        #conteinerbotao{
            text-align: center;
        }

        input[type=number] {
            width: 80px
        }

        input[type=button], input[type=submit], input[type=reset] {
            padding: 10px 20px;
            margin-top: 16px;
            font: normal 12pt Arial;
            cursor: pointer;
              
        }

        .valor{
            border:none;
        }

        .texto{
            text-align: center;
            padding-top: 30px;
        }

        #res, #res1, #resultado{
            text-align: center;
        }
    </style>

</head>

<body>

    <h1>Dimensionamento à Flexo-Tração</h1>

    <section>
    <table>
        <tr>
            <td>Informação</td>
            <td>Valor</td>
            <td>Unidade</td>
        </tr>

        <tr>
            <td class="info" >Resistência característica à compressão do concreto </td>
            <td class="valor"><input type="number" name="fck" id="fck"></td>
            <td class="unidade">MPa</td>
        </tr>

        <tr>
            <td class="info" >Tensão de escoamento característica do aço </td>
            <td class="valor"><input type="number" name="fyk" id="fyk"></td>
            <td class="unidade">MPa</td>
        </tr>

        <tr>
            <td class="info" >Módulo de elasticidade do aço</td>
            <td class="valor"><input type="number" name="es" id="es"></td>
            <td class="unidade">GPa</td>
        </tr>

        <tr>
            <td class="info" >Coeficiente parcial de segurança para o concreto</td>
            <td class="valor"><input type="number" name="gamac" id="gamac"></td>
            <td class="unidade"> --- </td>
        </tr>

        <tr>
            <td class="info" >Coeficiente parcial de segurança para o aço</td>
            <td class="valor"><input type="number" name="gamas" id="gamas"></td>
            <td class="unidade"> --- </td>
        </tr>

        <tr>
            <td class="info" >Coeficiente parcial de segurança para os esforços</td>
            <td class="valor"><input type="number" name="gamaf" id="gamaf"></td>
            <td class="unidade"> --- </td>
        </tr>

        <tr>
            <td class="info" >Coeficiente beta de redistribuição de momentos</td>
            <td class="valor"><input type="number" name="bduct" id="bduct"></td>
            <td class="unidade"> --- </td>
        </tr>

        <tr>
            <td class="info" >Largura da seção transversal</td>
            <td class="valor"><input type="number" name="b" id="b"></td>
            <td class="unidade"> cm </td>
        </tr>

        <tr>
            <td class="info" >Altura da seção transversal</td>
            <td class="valor"><input type="number" name="h" id="h">
            <td class="unidade"> cm </td>
        </tr>

        <tr>
            <td class="info" >Altura útil da seção transversal</td>
            <td class="valor"><input type="number" name="d" id="d">
            <td class="unidade"> cm </td>
        </tr>

        <tr>
            <td class="info" >Parâmetro d'</td>
            <td class="valor"><input type="number" name="dl" id="dl">
            <td class="unidade"> cm </td>
        </tr>

        <tr>
            <td class="info" >Momento fletor de serviço em kN.m</td>
            <td class="valor"><input type="number" name="amk" id="amk">
            <td class="unidade"> KN.m </td>
        </tr>

        <tr>
            <td class="info" >Esforço normal de serviço em kN</td>
            <td class="valor"><input type="number" name="ank" id="ank">
            <td class="unidade"> KN </td>
        </tr>
</table>

<div id="conteinerbotao">
    <td><input type="button" value="Calcular" onclick="calcular()"> </td>
</div>

<p></p>
<div id = 'res' class="texto">Qual a área de aço??</div>
<p></p>
<div id = 'res1' class="texto"></div>

</section>

<footer>
    <p>Rotinas computacionais adaptadas do livro: Programas para dimensionamento e verificação de concreto armado - José Milton de araújo</p>
    <p>Prof. Márcio W. Moura</p>
</footer>


<script>
    // Trecho JS do código
    function calcular() {

        //Cálculo das tensões no aço
        function tensao(esl) {
            ess = Math.abs(esl)
            eyd = fyd / es
            if (ess < eyd) {
                tsl = es * ess
            } else {
                tsl = fyd
            }
            // Trocando o sinal se necessário
            if (esl < 0) {
                tsl = -tsl
            }
            return tsl;
        }
        // Entrada de dados
        var fck = Number(document.getElementById('fck').value); 
        var fyk = Number(document.getElementById('fyk').value);
        var es = Number(document.getElementById('es').value);
        var gamac = Number(document.getElementById('gamac').value);
        var gamas = Number(document.getElementById('gamas').value);
        var gamaf = Number(document.getElementById('gamaf').value);
        var bduct = Number(document.getElementById('bduct').value);
        var b = Number(document.getElementById('b').value);
        var h = Number(document.getElementById('h').value);
        var d = Number(document.getElementById('d').value);
        var dl = Number(document.getElementById('dl').value);
        var amk = Number(document.getElementById('amk').value);
        var ank = Number(document.getElementById('ank').value);

        var test = 0
        // Parâmetros do diagrama retangular
        if (fck <= 50) {
            alamb = 0.8
            alfac = 0.85
            eu = 3.5
            qlim = 0.8 * bduct - 0.35
        } else {
            alamb = 0.8 - (fck - 50) / 400
            alfac = 0.85 * (1 - (fck - 50) / 200)
            eu = 2.6 + 35 * ((90 - fck) / 100) ** 4
            qlim = 0.8 * bduct - 0.45
        }

        // Conversão de unidades: transformando para kN e cm
        amk = 100 * amk
        fck = fck / 10
        fyk = fyk / 10
        es = 100 * es

        // Resistências de cálculo
        fcd = fck / gamac
        tcd = alfac * fcd
        fyd = fyk / gamas

        // Esforços solicitantes de cálculo
        amd = gamaf * amk
        aand = gamaf * ank

        // Parâmetro geométrico
        delta = dl / d
        
        // Esforços reduzidos solicitantes
        ami = amd / (b * d * d * tcd)
        ani = aand / (b * d * tcd)
        
        // Realização do dimensionamento
        // Momento reduzido que define o final do domínio 1
        ami0 = 0.5 * (1 - delta) * ani

        if (ami <= ami0) {
            // O problema será resolvido no domínio 1
            // Trata-se de flexo-tração com pequena excentricidade
            // Variável para indicar o domínio
            idom = 1
            // Taxas mecânicas de armadura
            wl = (ami0 - ami) / (1 - delta)
            w = (ami0 + ami) / (1 - delta)
        } else {
            // O problema será resolvido nos domínios 2 e 3
            // Trata-se de flexo-tração com grande excentricidade
            // Variável para indicar o domínio
            idom = 2
            // Momento equivalente
            amisd = ami - ami0
            // Momento limite
            amilim = alamb * qlim * (1 - 0.5 * alamb * qlim)
            if (amisd < amilim) {
                // Armadura simples
                qsi = (1 - Math.sqrt(1 - 2 * amisd)) / alamb
                w = alamb * qsi + ani
                wl = 0
            } else {
                // Armadura dupla
                // Evitando armadura dupla no domínio 2
                qsia = eu / (eu + 10)
                if (qlim < qsia) {
                    // Está resultando armadura dupla no domínio 2.
                    // Colocar mensagem para o usuário aumentar as dimensões da seção transversal e parar o processamento.
                    test = 1
                    //print('Resultou armadura dupla no domínio 2.')
                    //print('Aumente as dimensões da seção transversal.')    
                }
                if (qlim <= delta) {
                    // Colocar mensagem para o usuário aumentar as dimensões da seção transversal e parar o processamento.
                    test = 1
                    //print('Aumente as dimensões da seção transversal.')
                }
                // Deformação da armadura de compressão
                esl = eu * (qlim - delta) / qlim
                esl = esl / 1000
                // Tensão na armadura de compressão
                // Chamar sub-rotina
                tsl = tensao(esl)
                // Taxas mecânicas de armadura
                wl = (amisd - amilim) * fyd / ((1 - delta) * tsl)
                w = alamb * qlim + (amisd - amilim) / (1 - delta) + ani
            }
        }            
        // Áreas das armaduras
        aas = w * b * d * tcd / fyd
        asl = wl * b * d * tcd / fyd
        // Armadura mínima
        // Voltando para MPa
        fck = 10 * fck
        fyd = 10 * fyd
        // Romin da tração simples
        a = 2 / 3
        if (fck <= 50) {
            r1min = 0.39 * (fck ** a) / fyd
        } else {
            r1min = 2.756 * Math.log10(1 + 0.11 * fck) / fyd
        }
        // Romin da flexão simples
        if (fck <= 50) {
            r2min = 0.078 * (fck ** a) / fyd
        } else {
            r2min = 0.5512 * Math.log10(1 + 0.11 * fck) / fyd
        }
        if (r2min < 0.0015) {
            r2min = 0.0015
        }
        if (idom == 2) {
            // A solução do problema caiu no domínio 2 ou 3
            romin = r2min
        } else {
            // A solução caiu no domínio 1
            // A taxa mínima será interpolada entre r1min e r2min
            romin = r2min + (r1min - r2min) * (ami0 - ami) / ami0
        }
        // Armadura mínima
        asmin = romin * b * h
        if ((idom == 2) && (aas < asmin)) {
            // Domínios 2 e 3: apenas aas respeita a armadura mínima
            aas = asmin
        }
        if (idom == 1) {
            // Domínio 1: a soma aas+asl respeita a armadura mínima
            astot = aas + asl
            if (astot < asmin) {
                aas = aas * asmin / astot
                asl = asl * asmin / astot
            }
        }
        // Mostrando os resultados

        // Verificação de erros e saída de resultados
        while (fck == 0 || fyk == 0 || es == 0 || gamac == 0 || gamas == 0 || gamaf == 0 || bduct == 0 || b == 0 || h == 0 || d == 0 || amk == 0 || ank == 0) {
            test = 2
            window.alert('[ERRO] Problema na inserção dos dados de entrada!')
            break
        }    
        if (test == 1) {
            res.innerHTML = `<strong>${'Aumente as dimensões da seção transversal.'}</strong>`
        } else if (test == 2) {
            res.innerHTML = `<strong>Entre com os dados corretamente!</strong>`
        } else {
            res.innerHTML = `<strong>A área da armadura longitudinal positiva é ${aas.toFixed(2)} cm².</strong>`
            res1.innerHTML = `<strong>A área da armadura longitudinal negativa é ${asl.toFixed(2)} cm².</strong>`
        }
    }
</script>
</body>
</html>