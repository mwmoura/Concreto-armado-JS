<!DOCTYPE html>
<html lang="pt-br">
<head>
    <!-- Dimensionamento de seções retangulares à flexão normal simples -->
    <!-- ############################################################## -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flexão Normal - Dimensionamento</title>

    <style>
        /* Trecho CSS do código */
        body{
            font: normal 12pt Arial;
            background: rgb(70, 142, 241);
        }

        section{
            background-color: white;
            padding-top: 30px;
            box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.397);
            border-radius: 10px;
            margin: auto;
        }

        td{
            border: solid black 1px;
            text-align: center;
        }

        footer{
            text-align: center;
            padding-top: 50px;
            font-style: italic;
        }

        h1{
            text-align: center;
        }

        table{
            margin: auto;
        }

        #conteinerbotao{
            text-align: center;
        }

        input[type=number] {
            width: 80px
        }

        input[type=button], input[type=submit], input[type=reset] {
            padding: 10px 20px;
            margin-top: 16px;
            font: normal 12pt Arial;
            cursor: pointer;
              
        }

        .valor{
            border:none;
        }

        .texto{
            text-align: center;
            padding-top: 30px;
        }

        #res, #res1, #resultado{
            text-align: center;
        }
    </style>

</head>

<body>

    <h1>Dimensionamento à flexão normal simples</h1>

    <section>
    <table>
        <tr>
            <td>Informação</td>
            <td>Valor</td>
            <td>Unidade</td>
        </tr>

        <tr>
            <td class="info" >Resistência característica à compressão do concreto </td>
            <td class="valor"><input type="number" name="fck" id="fck"></td>
            <td class="unidade">MPa</td>
        </tr>

        <tr>
            <td class="info" >Tensão de escoamento característica do aço </td>
            <td class="valor"><input type="number" name="fyk" id="fyk"></td>
            <td class="unidade">MPa</td>
        </tr>

        <tr>
            <td class="info" >Módulo de elasticidade do aço</td>
            <td class="valor"><input type="number" name="es" id="es"></td>
            <td class="unidade">GPa</td>
        </tr>

        <tr>
            <td class="info" >Coeficiente parcial de segurança para o concreto</td>
            <td class="valor"><input type="number" name="gamac" id="gamac"></td>
            <td class="unidade"> --- </td>
        </tr>

        <tr>
            <td class="info" >Coeficiente parcial de segurança para o aço</td>
            <td class="valor"><input type="number" name="gamas" id="gamas"></td>
            <td class="unidade"> --- </td>
        </tr>

        <tr>
            <td class="info" >Coeficiente parcial de segurança para o momento</td>
            <td class="valor"><input type="number" name="gamaf" id="gamaf"></td>
            <td class="unidade"> --- </td>
        </tr>

        <tr>
            <td class="info" >Coeficiente beta de redistribuição de momentos</td>
            <td class="valor"><input type="number" name="bduct" id="bduct"></td>
            <td class="unidade"> --- </td>
        </tr>

        <tr>
            <td class="info" >Largura da seção transversal</td>
            <td class="valor"><input type="number" name="b" id="b"></td>
            <td class="unidade"> cm </td>
        </tr>

        <tr>
            <td class="info" >Altura da seção transversal</td>
            <td class="valor"><input type="number" name="h" id="h">
            <td class="unidade"> cm </td>
        </tr>

        <tr>
            <td class="info" >Altura útil da seção transversal</td>
            <td class="valor"><input type="number" name="d" id="d">
            <td class="unidade"> cm </td>
        </tr>

        <tr>
            <td class="info" >Parâmetro d'</td>
            <td class="valor"><input type="number" name="dl" id="dl">
            <td class="unidade"> cm </td>
        </tr>

        <tr>
            <td class="info" >Momento fletor de serviço em kN.m</td>
            <td class="valor"><input type="number" name="amk" id="amk">
            <td class="unidade"> KN.m </td>
        </tr>
</table>

<div id="conteinerbotao">
    <td><input type="button" value="Calcular" onclick="calcular()"> </td>
</div>

<p></p>
<div id = 'res' class="texto">Qual a área de aço??</div>
<p></p>
<div id = 'res1' class="texto"></div>

</section>

<footer>
    <p>Rotinas computacionais adaptadas do livro: Programas para dimensionamento e verificação de concreto armado - José Milton de araújo</p>
    <p>Prof. Márcio W. Moura</p>
</footer>


<script>
    // Trecho JS do código

    function calcular() {
        // Entrada de dados
        var fck = document.getElementById('fck')
        var fyk = document.getElementById('fyk')
        var es = document.getElementById('es')
        var gamac = document.getElementById('gamac')
        var gamas = document.getElementById('gamas')
        var gamaf = document.getElementById('gamaf')
        var bduct = document.getElementById('bduct')
        var b = document.getElementById('b')
        var h = document.getElementById('h')
        var d = document.getElementById('d')
        var dl = document.getElementById('dl')
        var amk = document.getElementById('amk')
        var fck1 = Number(fck.value)
        var fyk1 = Number(fyk.value)
        var es1 = Number(es.value)
        var gamac1 = Number(gamac.value)
        var gamas1 = Number(gamas.value)
        var gamaf1 = Number(gamaf.value)
        var bduct1 = Number(bduct.value)
        var b1 = Number(b.value)
        var h1 = Number(h.value)
        var d1 = Number(d.value)
        var dl1 = Number(dl.value)
        var amk1 = Number(amk.value)       
        // Parâmetros do diagrama retangular
        if (fck1 <= 50) {
            var alamb = 0.8
            var alfac = 0.85
            var eu = 3.5
            var qlim = 0.8 * bduct1 - 0.35
        } else {
            var alamb = 0.8 - (fck1 - 50) / 400
            var alfac = 0.85 * (1 - (fck1 - 50) / 200)
            var eu = 2.6 + 35 * ((90 - fck1) / 100) ** 4
            var qlim = 0.8 * bduct1 - 0.45
        }
        // Conversão de unidades: transformando para kN e cm
        amk = 100 * amk1
        fck = fck1 / 10
        fyk = fyk1 / 10
        es = 100 * es1
        // Resistências de cálculo
        fcd = fck / gamac1
        tcd = alfac * fcd
        fyd = fyk / gamas1
        amd = gamaf1 * amk
        // Parâmetro geométrico
        delta = dl1 / d1
        // Momento limite
        amilim = alamb * qlim * (1 - 0.5 * alamb * qlim)
        // Momento reduzido solicitante
        ami = amd / (b1 * d1 * d1 * tcd)
        if (ami <= amilim) {
            // Armadura simples
            var qsi = (1 - Math.sqrt(1 - 2 * ami)) / alamb
            aas = alamb * qsi * b1 * d1 * tcd / fyd
            asl = 0
        } else {
            // Armadura dupla
            qsia = eu / (eu + 10)
            if (qlim < qsia) {
                 // Evitando armadura dupla no domínio 2
                var test = 1
                var aviso = "Aumentar a seção transversal!"
            }
            if (qlim <= delta) {
                // Evitando armadura comprimida sob tração
                var test = 1
                var aviso = "Aumentar a seção transversal!"
            }
            // Deformação da armadura de compressão
            esl = eu * (qlim - delta) / qlim
            esl = esl / 1000
            ess = Math.abs(esl)
            eyd = fyd / es
            // Cálculo da tensão no aço
            if (ess < eyd) {
                tsl = es * ess
            } else {
                tsl = fyd
            }
            if (esl < 0) {
                tsl = -tsl
            }
            // Cálculo das áreas de aço quando armadura dupla
            asl = (ami - amilim) * b1 * d1 * tcd / ((1 - delta) * tsl)
            aas = (alamb * qlim + (ami - amilim) / (1 - delta)) * b1 * d1 * tcd / fyd
        }
        // Armadura mínima    
        a = 2 / 3
        fck = 10 * fck
        fyd = 10 * fyd
        if (fck <= 50) {
            romin = 0.078 * (fck ** a) / fyd
        } else {
            romin = 0.5512 * Math.log10(1 + 0.11 * fck) / fyd
        }
        if (romin < 0.0015) {
            romin = 0.0015
        }
        asmin = romin * b1 * h1
        if (aas < asmin) {
            aas = asmin
        }
        // Verificação de erros e saída de resultados
        while (fck == 0 || fyk == 0 || es == 0 || gamac == 0 || gamas == 0 || gamaf == 0 || bduct == 0 || b == 0 || h == 0 || d == 0 || dl == 0 || amk == 0) {
            test = 2
            window.alert('[ERRO] Problema na inserção dos dados de entrada!')
            break
        }    
        if (test == 1) {
            res.innerHTML = `<strong>${aviso}</strong>`
        } else if (test == 2) {
            res.innerHTML = `<strong>Entre com os dados corretamente!</strong>`
        } else {
            res.innerHTML = `<strong>A área de aço tracionada é ${aas.toFixed(2)} cm².</strong>`
            res1.innerHTML = `<strong>A área de aço comprimida é ${asl.toFixed(2)} cm².</strong>`
        }
    }
</script>
</body>
</html>